<!DOCTYPE html>
<html>
<head>
    <title>Image Analytics CRUD App</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { color: #333; }
        input, button { margin: 5px 0; padding: 5px; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        tr:hover { background-color: #f9f9f9; }
    </style>
</head>
<body>

<h1>Image Analytics CRUD App</h1>

<h3>Create / Update Item</h3>
<input type="hidden" id="itemId" />
<label>Name: </label><br/>
<input type="text" id="name" /><br/>
<label>Description: </label><br/>
<input type="text" id="description" /><br/>
<button onclick="createOrUpdateItem()">Save Item</button>

<h3>All Items</h3>
<table id="itemsTable">
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Description</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
const apiUrl = "/api/data";

// Fetch and display all items
function fetchItems() {
    fetch(apiUrl)
    .then(res => res.json())
    .then(data => {
        const tbody = document.querySelector("#itemsTable tbody");
        tbody.innerHTML = "";
        data.forEach(item => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${item.id}</td>
                <td>${item.name || ""}</td>
                <td>${item.description || ""}</td>
                <td>
                    <button onclick="editItem(${item.id})">Edit</button>
                    <button onclick="deleteItem(${item.id})">Delete</button>
                </td>
            `;
            tbody.appendChild(row);
        });
    });
}

// Create or update item
function createOrUpdateItem() {
    const id = document.getElementById("itemId").value;
    const name = document.getElementById("name").value;
    const description = document.getElementById("description").value;
    const data = { name, description };

    if (id) {
        // Update
        fetch(`${apiUrl}/${id}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        }).then(() => {
            clearForm();
            fetchItems();
        });
    } else {
        // Create
        fetch(apiUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        }).then(() => {
            clearForm();
            fetchItems();
        });
    }
}

// Edit item
function editItem(id) {
    fetch(`${apiUrl}/${id}`)
    .then(res => res.json())
    .then(item => {
        document.getElementById("itemId").value = item.id;
        document.getElementById("name").value = item.name;
        document.getElementById("description").value = item.description;
    });
}

// Delete item
function deleteItem(id) {
    if (confirm("Are you sure you want to delete this item?")) {
        fetch(`${apiUrl}/${id}`, { method: "DELETE" })
        .then(() => fetchItems());
    }
}

// Clear form
function clearForm() {
    document.getElementById("itemId").value = "";
    document.getElementById("name").value = "";
    document.getElementById("description").value = "";
}

// Initial fetch
fetchItems();
</script>

</body>
</html>
